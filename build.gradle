/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Kotlin application project to get you started.
 */

plugins {
    id 'org.jetbrains.kotlin.multiplatform' version '1.3.41'
}

repositories {
    // Use jcenter for resolving dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
}

kotlin {
    jvm() {
    }
    js() {
        compilations.main.kotlinOptions {
            moduleKind='amd'
        }
    }
    sourceSets {
        commonMain {
            dependencies {
                implementation kotlin('stdlib')
                implementation kotlin('stdlib-js')
             } 
        }
        commonTest {
            dependencies {
                implementation kotlin('test-common')
                implementation kotlin('test')
                implementation kotlin('test-junit')
                implementation kotlin('test-js')
            }
        }
        jsMain {
            dependencies {
                implementation kotlin('stdlib')
                implementation kotlin('stdlib-js')
                implementation 'org.jetbrains.kotlinx:kotlinx-html-js:0.6.12'
            }
        }
        jvmMain {
            dependencies {
               implementation kotlin('stdlib') 
               implementation 'javax.servlet:javax.servlet-api:4.0.1'
            }
        }
    }
    targets.all {
        
    }
}
    
allprojects {
    task hello1 {
        doLast {
            task ->
                println "$task.project.name"
        }   
    }
}

class GreetingToFileTask extends DefaultTask {
    def dest

    File getDestination() {
        project.file(dest)
    }
    @TaskAction
    def myTask() {
        def file = getDestination()
        file.parentFile.mkdirs()
        file.write 'Good evening!'
    }
}

task myTask(type: GreetingToFileTask) {
    dest  = { project.greetingFile }
}


task sayGreeting(dependsOn: myTask) {
    doLast {
        println file(greetingFile).text
    }
}

ext.greetingFile = "$buildDir/hello.txt"

